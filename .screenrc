# Escape
#escape ^Tt
escape ^Qq

# Disable t
#bind t
#bind ^t

# Only: Q (default)
bind q only
#bind ^q only

# source setup file
#bind q eval "source $HOME/.screenrc"
bind t eval "source $HOME/.screenrc"

# Scroll back
defscrollback 10000

# Don't show start up message
startup_message off

# Auto detach
autodetach on

# Show action in the hidden window
defmonitor on

# hardcopydir
hardcopydir $HOME/screenlog

# Time (second) to show message
msgwait 10

# Remove background color
#defbce "on"

# kill
bind K kill

# Use bright color for the characters
attrcolor b ".I"

# Clear scrollback buffer
bind F eval 'scrollback 0' 'scrollback 1000' 'echo "scrollback buffer cleared"'

# Don't clear after finishing application
altscreen on

# disable loginmode (if update /var/run/utmp)
deflogin on

# Modify window list
bind w  windowlist -b
#bind ^W windowlist -b
#bind ^W windowlist -b -m # sorting by most-recentry-used list.
##disable...
#bind w 
bind ^W

# Clear display before detachment
#bind d eval 'only' 'clear' 'detach'

# Colors for other messages, including center line
#sorendition "+rb .w"
sorendition " .K"

# Remove
# x: default lockscreen
bind x remove

# Continuous window change
bind ^n eval 'next'
bind ^p eval 'prev'
#bind ^n eval 'command -c window' 'next'
#bind ^p eval 'command -c window' 'prev'
bind -c window n eval 'next'
bind -c window p eval 'prev'
bind -c window ^n eval 'command -c window' 'next'
bind -c window ^p eval 'command -c window' 'prev'
bind -c window ^q eval 'command -c window'

# Focus (like vi)
#bind l focus next
#bind h focus prev
bind h  eval 'focus left'
bind j  eval 'focus down'
bind k  eval 'focus up'
bind l  eval 'focus right'
#bind ^h eval    'command -c move' 'focus left'
#bind -k kb eval 'command -c move' 'focus left' #Backspace
#bind ^j eval    'command -c move' 'focus down'
#bind ^k eval    'command -c move' 'focus up'
#bind ^l eval    'command -c move' 'focus right'
#bind ^q eval    'command -c move'
bind ^h eval    'focus left'
bind -k kb eval 'focus left' #Backspace
bind ^j eval    'focus down'
bind ^k eval    'focus up'
bind ^l eval    'focus right'

#bind -c move h eval 'focus left'
#bind -c move j eval 'focus down'
#bind -c move k eval 'focus up'
#bind -c move l eval 'focus right'
#bind -c move ^h eval    'command -c move' 'focus left'
#bind -c move -k kb eval 'command -c move' 'focus left' #Backspace
#bind -c move ^j eval    'command -c move' 'focus down'
#bind -c move ^k eval    'command -c move' 'focus up'
#bind -c move ^l eval    'command -c move' 'focus right'
#bind -c move ^q eval    'command -c move'

# Split
bind V split -v
bind S split

# Layout
# Layout command prefix C-q
bind ^q eval 'command -c layout' 'layout show'
bind -c layout ^q eval 'command -c layout' 'layout show'
# Make/Remove layout
bind -c layout c eval 'command -c layout' 'layout new' 'layout show'
bind -c layout x eval 'command -c layout' 'layout remove' 'layout show'
# Modify title/number
bind -c layout T colon 'layout title '
bind -c layout N colon 'layout number '
# Go to Next/Previous layout
bind -c layout n eval 'layout next' 'layout show'
bind -c layout p eval 'layout prev' 'layout show'
bind -c layout ^N eval 'command -c layout' 'layout next' 'layout show'
bind -c layout ^P eval 'command -c layout' 'layout prev' 'layout show'
# Choose n-th layout
bind -c layout 0 eval 'command -c layout' 'layout select 0' 'layout show'
bind -c layout 1 eval 'command -c layout' 'layout select 1' 'layout show'
bind -c layout 2 eval 'command -c layout' 'layout select 2' 'layout show'
bind -c layout 3 eval 'command -c layout' 'layout select 3' 'layout show'
bind -c layout 4 eval 'command -c layout' 'layout select 4' 'layout show'
bind -c layout 5 eval 'command -c layout' 'layout select 5' 'layout show'
bind -c layout 6 eval 'command -c layout' 'layout select 6' 'layout show'
bind -c layout 7 eval 'command -c layout' 'layout select 7' 'layout show'
bind -c layout 8 eval 'command -c layout' 'layout select 8' 'layout show'
bind -c layout 9 eval 'command -c layout' 'layout select 9' 'layout show'
# Initialize layouts
bind -c layout i eval 'echo "Initialize layouts..."' 'screen' 'screen' 'screen' 'layout new only' 'only' 'select 0' 'layout new 4-windows' 'only' 'select 0' 'split' 'split -v' 'focus' 'select 1' 'focus' 'select 2' 'split -v' 'focus' 'select 3' 'focus' 'layout new 3-win_1-top' 'only' 'select 0' 'split' 'resize -v 70%' 'focus' 'select 1' 'split -v' 'focus' 'select 2' 'focus' 'layout new 3-win_1-left' 'only' 'select 0' 'split -v' 'focus' 'select 1' 'split' 'focus' 'select 2' 'focus' 'layout new monitor' 'only' 'select 0' 'split' 'resize -v 80%' 'focus' 'select 1' 'split -v' 'split -v' 'focus' 'select 2' 'focus' 'select 3' 'focus' 'layout select 4-windows'
bind -c layout ^i eval 'echo "Initialize layouts..."' 'screen' 'screen' 'screen' 'layout new only' 'only' 'select 0' 'layout new 4-windows' 'only' 'select 0' 'split' 'split -v' 'focus' 'select 1' 'focus' 'select 2' 'split -v' 'focus' 'select 3' 'focus' 'layout new 3-win_1-top' 'only' 'select 0' 'split' 'resize -v 70%' 'focus' 'select 1' 'split -v' 'focus' 'select 2' 'focus' 'layout new 3-win_1-left' 'only' 'select 0' 'split -v' 'focus' 'select 1' 'split' 'focus' 'select 2' 'focus' 'layout new monitor' 'only' 'select 0' 'split' 'resize -v 80%' 'focus' 'select 1' 'split -v' 'split -v' 'focus' 'select 2' 'focus' 'select 3' 'focus' 'layout select 4-windows'
# Reset layouts
bind -c layout r eval 'echo "Reset layouts..."' 'layout select only' 'only' 'select 0' 'layout select 4-windows' 'only' 'select 0' 'split' 'split -v' 'focus' 'select 1' 'focus' 'select 2' 'split -v' 'focus' 'select 3' 'focus' 'layout select 3-win_1-top' 'only' 'select 0' 'split' 'resize -v 70%' 'focus' 'select 1' 'split -v' 'focus' 'select 2' 'focus' 'layout select 3-win_1-left' 'only' 'select 0' 'split -v' 'focus' 'select 1' 'split' 'focus' 'select 2' 'focus' 'layout select monitor' 'only' 'select 0' 'split' 'resize -v 80%' 'focus' 'select 1' 'split -v' 'split -v' 'focus' 'select 2' 'focus' 'select 3' 'focus' 'layout select 4-windows'
bind -c layout ^r eval 'echo "Reset layouts..."' 'layout select only' 'only' 'select 0' 'layout select 4-windows' 'only' 'select 0' 'split' 'split -v' 'focus' 'select 1' 'focus' 'select 2' 'split -v' 'focus' 'select 3' 'focus' 'layout select 3-win_1-top' 'only' 'select 0' 'split' 'resize -v 70%' 'focus' 'select 1' 'split -v' 'focus' 'select 2' 'focus' 'layout select 3-win_1-left' 'only' 'select 0' 'split -v' 'focus' 'select 1' 'split' 'focus' 'select 2' 'focus' 'layout select monitor' 'only' 'select 0' 'split' 'resize -v 80%' 'focus' 'select 1' 'split -v' 'split -v' 'focus' 'select 2' 'focus' 'select 3' 'focus' 'layout select 4-windows'
# Set layout
bind -c layout m eval 'command -c  layoutm' 'echo "0 only, l 4-windows, 2 3-win_1-top, 3 3-win_1-top, 4 monitor (1 top, 3 small bottoms), 5 split, 6 vsplit, "'
bind -c layoutm 0 eval 'only' 'layout show'
bind -c layoutm 1 eval 'only' 'only' 'select 0' 'split' 'split -v' 'focus' 'select 1' 'focus' 'select 2' 'split -v' 'focus' 'select 3' 'focus' 'layout show'
bind -c layoutm 2 eval 'only' 'select 0' 'split' 'resize -v 70%' 'focus' 'select 1' 'split -v' 'focus' 'select 2' 'focus'
bind -c layoutm 3 eval 'only' 'select 0' 'split -v' 'focus' 'select 1' 'split' 'focus' 'select 2' 'focus' 
bind -c layoutm 4 eval 'only' 'select 0' 'split' 'resize -v 80%' 'focus' 'select 1' 'split -v' 'split -v' 'focus' 'select 2' 'focus' 'select 3' 'focus'
bind -c layoutm 5 eval 'only' 'select 0' 'split' 'focus' 'select 1' 'focus'
bind -c layoutm 6 eval 'only' 'select 0' 'split -v' 'focus' 'select 1' 'focus'

# Make 4 window with new 4 screen
bind s eval 'layout select 4-windows' 'screen' 'screen' 'screen' 'only' 'split' 'select 0' 'split -v' 'focus' 'select 1' 'focus' 'select 2' 'split -v' 'focus' 'select 3' 'focus'
bind ^s eval 'layout select 4-windows' 'screen' 'screen' 'screen' 'only' 'split' 'select 0' 'split -v' 'focus' 'select 1' 'focus' 'select 2' 'split -v' 'focus' 'select 3' 'focus'

# Make 4 window with no new screen
bind r eval 'layout select 4-windows' 'only' 'split' 'select 0' 'split -v' 'focus' 'select 1' 'focus' 'select 2' 'split -v' 'focus' 'select 3' 'focus'
bind ^r eval 'layout select 4-windows' 'only' 'split' 'select 0' 'split -v' 'focus' 'select 1' 'focus' 'select 2' 'split -v' 'focus' 'select 3' 'focus'

# Resize window
bind e eval 'command -c resize' 'echo "Resize window"'
bind ^e eval 'command -c resize' 'echo "Resize window"'
bind -c resize h eval 'command -c resize' 'resize -h -1'
bind -c resize l eval 'command -c resize' 'resize -h +1'
bind -c resize j eval 'command -c resize' 'resize -v +1'
bind -c resize k eval 'command -c resize' 'resize -v -1'
bind -c resize ^h eval 'command -c resize' 'resize -h -1'
bind -c resize ^l eval 'command -c resize' 'resize -h +1'
bind -c resize ^j eval 'command -c resize' 'resize -v +1'
bind -c resize ^k eval 'command -c resize' 'resize -v -1'

# Clip board, xclip or xsel?
# xsel (xclip also?) sometime remains like zombie...?
bufferfile "$SCREENEXCHANGE"

#bindkey -m ' ' eval 'stuff \040' 'writebuf' "!bash -c 'source ~/.bashrc && myclpushsc'"
bindkey -m ' ' eval 'stuff \040' 'writebuf' 'exec !!! multi_clipboards -I'
bindkey -m Y eval 'stuff Y' 'writebuf' 'exec !!! multi_clipboards -I'
bindkey -m W eval 'stuff W' 'writebuf' 'exec !!! multi_clipboards -I'

#bind a eval "!bash -c 'source ~/.bashrc && myclpopsc'"
bind a eval "!bash -c 'multi_clipboards -O;echo -n \"$SCREEN_PS1\"'"
bind ^a eval "!bash -c 'multi_clipboards -O;echo -n \"$SCREEN_PS1\"'"

# Term
#term "screen-256color"

# not change the window size when it is attached
termcapinfo xterm-256color 'is=\E[r\E[m\E[2J\E[H\E[?7h\E[?1;4;6l'
termcapinfo xterm 'is=\E[r\E[m\E[2J\E[H\E[?7h\E[?1;4;6l'

# xterm understands both im/ic and doesn't have a status line.
# Note: Do not specify im and ic in the real termcap/info file as
# some programs (e.g. vi) will (no,no, may (jw)) not work anymore.
termcap xterm|fptwist hs@:cs=\E[%i%d;%dr:im=\E[4h:ei=\E[4l
terminfo xterm|fptwist hs@:cs=\E[%i%p1%d;%p2%dr:im=\E[4h:ei=\E[4l
termcap xterm-256color|fptwist hs@:cs=\E[%i%d;%dr:im=\E[4h:ei=\E[4l
terminfo xterm-256color|fptwist hs@:cs=\E[%i%p1%d;%p2%dr:im=\E[4h:ei=\E[4l

# Long time I had this in my private screenrc file. But many people
# seem to want it (jw):
# we do not want the width to change to 80 characters on startup:
# on suns, /etc/termcap has :is=\E[r\E[m\E[2J\E[H\E[?7h\E[?1;3;4;6l:
termcap xterm 'is=\E[r\E[m\E[2J\E[H\E[?7h\E[?1;4;6l'
terminfo xterm 'is=\E[r\E[m\E[2J\E[H\E[?7h\E[?1;4;6l'
termcap xterm-256color 'is=\E[r\E[m\E[2J\E[H\E[?7h\E[?1;4;6l'
terminfo xterm-256color 'is=\E[r\E[m\E[2J\E[H\E[?7h\E[?1;4;6l'

# Do not use xterms alternate window buffer.
# This one would not add lines to the scrollback buffer.
termcap xterm|xterms|xs ti=\E7\E[?47l
terminfo xterm|xterms|xs ti=\E7\E[?47l
termcap xterm-256color|xterms|xs ti=\E7\E[?47l
terminfo xterm-256color|xterms|xs ti=\E7\E[?47l

# Caption for each window
caption always '%?%F%{=d Wk}%:%{=d Kk}%?%?%P%{=d Bk}%?%n %L=%h%L>%=%?%P *copy/paste*%?%?%E ***command**%?%-0='
#caption always '%?%F%{=d Wk}%:%{=d Kk}%?%?%P%{=d Bk}%?%n %L=%h%>%?%P *** copy/paste mode ***%?%?%E *** command mode ***%?%-0='
# %?%F      # if the window has the focus
#  %{=d Wk} #   set attribute = {dim, black(k) on bright Write(W)}
# %:        # else
#  %{=d Kk} #   set attribute = {dim, black(k) on bright Black(K)}
# %?        # end if
# %?%P      # if copy/paste mode
#   %{=d Bk}#   set attribute = {dim, black(k) on bright Blue(B)}
# %?        # end if
# %n        # window number
#           # space
# %L=       # Mark the position for the next truncation
# %h        # window' hardstatus
# %L>       # Truncate %L= ~ %L>, 'L' for > gives marks at the truncation point
# %=        # With the last %-0=, it makes right alignment for following lines
# %?%P      # if copy/paste mode
#   *copy/paste* # draw this sentence
# %?        # end if
# %?%E      # if copy/paste mode
#   ***command** # draw this sentence
# %?        # end if
# %-0=      # pad the string to the display's width. "-0" means start from
#           # the rightest side 
#           # (e.g. 10=: 10% from left, 010, 10 characters from left
#           # (     -10=: 10% from right)
#           # With %L>, %= above, screen tries to truncates the part 
#           # in the left of "%L>"

# hardstatus
hardstatus alwayslastline "%{= Kk}%-w%40>%{= Wk}%n %t%{-}%+w%-0="
# %{= Kk}   # set attribute = {black(k) on bright Black(K)}
# %-w       # windows' list up to the current window (shown as "%n %t")
# %40>      # Mark here as a point to move when truncation
#           # Try to move this point to the 40% point
# %{= Wk}   # set attribute = {black(k) on bright Write(W)}
# %n        # current window number
#           # space
# %t        # current window title
# %{-}      # remove the set from the current attributes
# %+w       # windows' list starting with the window after the current one (shown as "%n %t")
# %-0=      # pad the string to the display's width.

# About Truncation/Padding(=,<,>)
# http://aperiodic.net/screen/truncation_padding_escapes
